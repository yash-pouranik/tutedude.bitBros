<% layout("layouts/boilerplate") %>

<div class="container my-5">
  <div class="card shadow-lg border-0">
    <div class="row g-0">
      <div class="col-md-5 text-center p-4">
        <img src="<%= product.imageUrl %>" alt="<%= product.name %>" class="img-fluid rounded" style="max-height: 300px; object-fit: contain;">
      </div>
      <div class="col-md-7 p-4">
        <h2 class="mb-3 fw-bold text-primary"><%= product.name %></h2>

        <p><span class="fw-semibold">Description:</span> <%= product.description || "N/A" %></p>
        <p><span class="fw-semibold">Type:</span> <%= product.type %></p>

        <% if (product.type === "fresh") { %>
          <p><span class="fw-semibold">Category:</span> <%= product.freshCategory %></p>
        <% } %>

        <p>
          <span class="fw-semibold">Price:</span>
          â‚¹<%= product.price %> per <%= product.unit %>
        </p>
        <p><span class="fw-semibold">Quantity Available:</span> <%= product.quantity %></p>
        <p><span class="fw-semibold">Available:</span> 
          <span class="<%= product.availability ? 'text-success' : 'text-danger' %>">
            <%= product.availability ? "Yes" : "No" %>
          </span>
        </p>
        <p class="mb-2"><strong>Supplier:</strong> <%= product.supplierId?.username || "N/A" %></p>


        <p><span class="fw-semibold">Added On:</span> <%= product.createdAt.toDateString() %></p>
      

      <% if (currUser && currUser.userType === 'vendor') { %>
  <a class="btn btn-primary mt-2" href="/product/<%= product._id %>/addcart">Add to Cart</a>
<% } else if (!currUser) { %>
  <a class="btn btn-primary mt-2" href="/login">Add to Cart</a>
<% } %>
<%
  const isOwner = currUser &&
    currUser.userType === 'supplier' &&
    String(product.supplierId._id) === String(currUser._id);
%>

<% if (isOwner) { %>
  <a href="/products/<%= product._id %>/edit" class="btn btn-warning mt-2">Edit Product</a>
  <form action="/products/<%= product._id %>/delete" method="POST" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this product?');">
    <input type="hidden" name="_method" value="DELETE">
    <input type="hidden" name="productId" value="<%= product._id %>">
  <button type="submit" class="btn btn-warning mt-2">Delete Product</button>
</form>
<% } %>

      
      </div>
    </div>
  </div>
</div>
